import{_ as F}from"./CTbYNERF.js";import{_ as v,o,c,a as t,b as f,d as g,t as d,n as I,F as $,i as k,w as b,k as u,f as S,v as D,r as N,h as p,D as M,I as O,s as P,u as V,y as n,z,B as j,ah as q}from"./DdQnp8wQ.js";import{_ as h}from"./NVYaaFKl.js";import{_ as A}from"./DCM5VtuO.js";import{u as G}from"./DieWdjBu.js";const W={components:{Icon:h},props:{header:{type:String,default:""},text:{type:String,default:""},headerColour:{type:String,default:"#FFFFFF"},icon:{type:String,default:"user.svg"}}},J={class:"report__textBox"},K=["innerHTML"];function Q(a,s,r,m,y,i){const l=h;return o(),c("div",J,[t("h2",{style:I({backgroundColor:r.headerColour}),class:"report__textBoxHeader"},[f(l,{filename:r.icon,style:{height:"1em",width:"1.2em"}},null,8,["filename"]),g(" "+d(r.header),1)],4),t("div",{class:"report__textBoxText",innerHTML:a.$md.render(r.text)},null,8,K)])}const T=v(W,[["render",Q],["__scopeId","data-v-626c55a7"]]),U={components:{ExtLink:A,Icon:h},props:{subject:{type:Object,default:()=>({})},profile:{type:Object,default:void 0}},computed:{filteredSubjectProperties(){const a=["name","trip_date","age","setting","gender","height","weight","medications"];return Object.keys(this.subject).filter(s=>s!=="pdf_url"&&this.subject[s]!=="").sort((s,r)=>a.indexOf(s)-a.indexOf(r))}},methods:{propertyLabel(a){return{name:"Name",trip_date:"Trip Date",age:"Age",setting:"Setting",gender:"Gender",height:"Height",weight:"Weight",medications:"Medications"}[a]}}},X={class:"report__infoBox"},Y={class:"report__infoBoxHeader"},Z={class:"report__infoBoxItemContainer"},ee={class:"label"},te={class:"value"},se={key:0,class:"tracker_pdf"};function ne(a,s,r,m,y,i){const l=h,e=A;return o(),c("section",X,[t("h2",Y,[f(l,{filename:"user.svg",style:{height:"1em",width:"1.2em","padding-right":"10px"}}),s[0]||(s[0]=g(" Context ",-1))]),t("div",Z,[(o(!0),c($,null,k(i.filteredSubjectProperties,_=>(o(),c("div",{key:_,class:"report__infoBoxItem"},[t("template",null,[t("div",ee,d(i.propertyLabel(_))+": ",1),t("div",te,d(r.subject[_]),1)])]))),128)),r.subject.pdf_url?(o(),c("div",se,[f(e,{href:r.subject.pdf_url},{default:b(()=>[...s[1]||(s[1]=[g(" Subjective Effect Tracker PDF ",-1)])]),_:1},8,["href"])])):u("",!0)])])}const oe=v(U,[["render",ne],["__scopeId","data-v-69b11ef9"]]),re={components:{Icon:h},props:{substances:{type:Array,default:()=>[]}}},ae={class:"report__infoBox"},ce={class:"report__infoBoxHeader"},ie={class:"report__infoBoxTableContainer"},le={class:"report__infoBoxTable"},de={class:"report__infoBoxTableName"},_e={class:"report__infoBoxTableDose"},ue={class:"report__infoBoxTableRoA"};function fe(a,s,r,m,y,i){const l=h;return o(),c("section",ae,[t("h2",ce,[f(l,{filename:"capsules.svg",class:"categoryIcon",style:{height:"1em",width:"1.4em","padding-right":"10px"}}),s[0]||(s[0]=g(" Substances ",-1))]),t("div",ie,[S(t("table",le,[s[1]||(s[1]=t("thead",null,[t("tr",{class:"report__infoBoxTableHeader"},[t("td",null," Name "),g(),t("td",null," Dosage "),g(),t("td",null," Route of Administration ")])],-1)),t("tbody",null,[(o(!0),c($,null,k(r.substances,(e,_)=>(o(),c("tr",{key:_},[t("td",de,d(e.name),1),t("td",_e,d(e.dose),1),t("td",ue,d(e.roa),1)]))),128))])],512),[[D,r.substances.length]])])])}const pe=v(re,[["render",fe]]),he={props:{log:{type:Array,default:()=>[]},headerColour:{type:String,default:"#FFFFFF"},header:{type:String,default:"Log"}},methods:{trimmedMarkdown(a){if(!a)return"";let s=this.$md.render(a);return s&&(s=s.trim()),s}}},me={class:"report__logBox"},ge={class:"report__logBoxContainer"},ye={class:"inner rotate"},ve={class:"content"},xe={key:0,class:"logTime"},be=["innerHTML"];function $e(a,s,r,m,y,i){return o(),c("section",me,[t("h2",{style:I({backgroundColor:r.headerColour}),class:"report__logBoxHeader"},d(r.header),5),t("div",ge,[t("div",{style:I({backgroundColor:r.headerColour}),class:"outer"},[t("div",ye,d(r.header),1)],4),t("div",ve,[(o(!0),c($,null,k(r.log,(l,e)=>(o(),c("div",{key:e,class:"logItem"},[l.time?(o(),c("div",xe,d(l.time)+": ",1)):u("",!0),t("div",{class:"logDescription",innerHTML:i.trimmedMarkdown(l.description)},null,8,be)]))),128))])])])}const w=v(he,[["render",$e],["__scopeId","data-v-486d456c"]]),ke={props:{value:{type:String,default:""}},methods:{clickTag(a){this.$router.push("/search?q="+a)}}};function Ee(a,s,r,m,y,i){return o(),c("div",{class:"tag",onClick:s[0]||(s[0]=l=>i.clickTag(r.value))},d(r.value),1)}const Be=v(ke,[["render",Ee],["__scopeId","data-v-50ee07e4"]]),Ce={components:{Icon:h},props:{effects:{type:Array,default:()=>[]},name:{type:String,default:"Name"},icon:{type:String,default:"eye.svg"}}},je={class:"category"},we={class:"titleContainer"},Ie={class:"effectList"};function Te(a,s,r,m,y,i){const l=h,e=F;return o(),c("div",je,[t("div",we,[f(l,{filename:r.icon,style:{height:"35px",width:"35px"}},null,8,["filename"]),t("h2",null,d(r.name),1)]),t("ul",Ie,[(o(!0),c($,null,k(r.effects,_=>(o(),c("li",{key:_._id},[f(e,{to:`/effects/${_.url}`,class:"effect"},{default:b(()=>[g(d(_.name),1)]),_:2},1032,["to"])]))),128))])])}const Fe=v(Ce,[["render",Te]]),Se={components:{RelatedEffectsCategory:Fe,Icon:h},props:{effects:{type:Array,default:()=>[]}},computed:{sensoryEffects(){return this.effects.filter(a=>a.tags.includes("sensory"))},physicalEffects(){return this.effects.filter(a=>a.tags.includes("physical"))},cognitiveEffects(){return this.effects.filter(a=>a.tags.includes("cognitive"))}}},De={class:"reportRelatedEffects"},Ae={class:"header"},Le={class:"categories"};function He(a,s,r,m,y,i){const l=h,e=N("related-effects-category");return o(),c("div",De,[t("div",Ae,[f(l,{filename:"sitemap.svg",style:{height:"1em",width:"1.2em","margin-right":"10px"}}),s[0]||(s[0]=t("h1",{class:"title"}," Related Effects ",-1))]),t("div",Le,[s[1]||(s[1]=t("p",{class:"description"}," This trip report seems to include the following subjective effects: ",-1)),i.sensoryEffects.length>0?(o(),p(e,{key:0,effects:i.sensoryEffects,name:"Sensory",icon:"eye.svg"},null,8,["effects"])):u("",!0),i.cognitiveEffects.length>0?(o(),p(e,{key:1,effects:i.cognitiveEffects,background:"#EEE",name:"Cognitive",icon:"user.svg"},null,8,["effects"])):u("",!0),i.physicalEffects.length>0?(o(),p(e,{key:2,effects:i.physicalEffects,name:"Physical",icon:"heart-rate.svg"},null,8,["effects"])):u("",!0)])])}const Re=v(Se,[["render",He]]),Ne={class:"report"},Me={class:"report__headerContainer"},Oe={class:"report__headerTitleContainer"},Pe={style:{display:"flex","flex-direction":"row","align-items":"center"}},Ve={class:"report__title",style:{"margin-bottom":"0"}},ze={key:0},qe={class:"report__titleAuthor"},Ge={key:0},We={key:1},Je={key:1},Ke={class:"report__tagsContainer"},Qe={class:"report__topSection"},Ue={class:"report__logsContainer"},st={__name:"index",async setup(a){let s,r;const m=M(),y=O(),i={_id:"",title:"",tags:[],subject:{name:"",trip_date:""},person:null,substances:[],introduction:"",conclusion:"",onset:[],peak:[],offset:[],related_effects:[]},{data:l}=([s,r]=P(async()=>G(`reports:detail:${String(m.params.slug||"")}`,async()=>{const{report:x}=await y(`/api/reports/slug/${m.params.slug}`);if(!x||x.unpublished===!0)throw q({statusCode:404,statusMessage:"That report does not exist."});return x},{watch:[()=>m.params.slug]})),s=await s,r(),s),e=j(()=>l.value||i),_=j(()=>{const E=(Array.isArray(e.value.substances)?e.value.substances.map(C=>C.name):[]).join(", "),B=e.value.subject?.name||"";return`A ${E} report from ${B} on Effect Index.`}),L=j(()=>e.value.related_effects&&e.value.related_effects.length>0);return V(()=>({title:e.value.title,meta:[{name:"description",hid:"description",content:_.value},{name:"og:title",hid:"og:title",content:`Effect Index - Trip Report - ${e.value.title} by ${e.value.subject?.name||""}`},{name:"og:description",hid:"og:description",content:_.value},{name:"twitter:title",hid:"twitter:title",content:`Effect Index - Trip Report - ${e.value.title} by ${e.value.subject?.name||""}`},{name:"twitter:description",hid:"twitter:description",content:_.value}]})),(x,E)=>{const B=F,C=z;return o(),c("article",Ne,[t("div",Me,[t("div",Oe,[t("div",Pe,[t("h1",Ve,d(n(e).title),1),f(C,null,{default:b(()=>[x.$auth.loggedIn?(o(),c("div",ze,[f(B,{to:`/admin/reports/${n(e)._id}`},{default:b(()=>[f(n(h),{style:{height:"20px",width:"20px",opacity:"0.6","margin-left":"15px"},filename:"edit.svg"})]),_:1},8,["to"])])):u("",!0)]),_:1})]),S(t("div",qe,[n(e).person?(o(),c("span",Ge,[E[0]||(E[0]=g(" by ",-1)),n(e).person.profile_url?(o(),p(B,{key:0,to:`/people/${n(e).person.profile_url}`},{default:b(()=>[g(d(n(e).person.full_name||n(e).person.alias),1)]),_:1},8,["to"])):(o(),c("span",We,d(n(e).person.full_name||n(e).person.alias),1))])):(o(),c("span",Je," by "+d(n(e).subject.name),1))],512),[[D,n(e).subject.name]])]),t("div",Ke,[(o(!0),c($,null,k(n(e).tags,(H,R)=>(o(),p(n(Be),{key:R,value:H},null,8,["value"]))),128))])]),t("div",Qe,[f(n(oe),{subject:n(e).subject},null,8,["subject"]),f(n(pe),{substances:n(e).substances},null,8,["substances"])]),n(e).introduction?(o(),p(n(T),{key:0,text:n(e).introduction,icon:"sun.svg","header-colour":"#EEE",header:"Introduction"},null,8,["text"])):u("",!0),t("div",Ue,[n(e).onset.length?(o(),p(n(w),{key:0,log:n(e).onset,"header-colour":"#DDFFDD",header:"Onset"},null,8,["log"])):u("",!0),n(e).peak.length?(o(),p(n(w),{key:1,log:n(e).peak,"header-colour":"#FFDDDD",header:"Peak"},null,8,["log"])):u("",!0),n(e).offset.length?(o(),p(n(w),{key:2,log:n(e).offset,"header-colour":"#DDDDFF",header:"Offset"},null,8,["log"])):u("",!0)]),n(e).conclusion?(o(),p(n(T),{key:1,text:n(e).conclusion,icon:"moon.svg","header-colour":"#EEE",header:"Conclusion / Aftermath"},null,8,["text"])):u("",!0),n(L)?(o(),p(n(Re),{key:2,effects:n(e).related_effects},null,8,["effects"])):u("",!0)])}}};export{st as default};
